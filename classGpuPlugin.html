<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.8"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Dobby: GpuPlugin Class Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">Dobby<span id="projectnumber">&#160;3.0</span>
   </div>
   <div id="projectbrief">Dobby “Docker based Thingy” is a tool for managing and running OCI containers using crun</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.8 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="#pri-methods">Private Member Functions</a> &#124;
<a href="#pri-attribs">Private Attributes</a> &#124;
<a href="classGpuPlugin-members.html">List of all members</a>  </div>
  <div class="headertitle"><div class="title">GpuPlugin Class Reference</div></div>
</div><!--header-->
<div class="contents">

<p><a class="el" href="classDobby.html" title="The root Dobby object, runs the dbus loop.">Dobby</a> GPU plugin.  
 <a href="classGpuPlugin.html#details">More...</a></p>

<p><code>#include &lt;<a class="el" href="GpuPlugin_8h_source.html">GpuPlugin.h</a>&gt;</code></p>
<div class="dynheader">
Inheritance diagram for GpuPlugin:</div>
<div class="dyncontent">
<div class="center"><img src="classGpuPlugin__inherit__graph.png" border="0" usemap="#aGpuPlugin_inherit__map" alt="Inheritance graph"/></div>
<map name="aGpuPlugin_inherit__map" id="aGpuPlugin_inherit__map">
<area shape="rect" title="Dobby GPU plugin." alt="" coords="28,152,116,177"/>
<area shape="rect" href="classRdkPluginBase.html" title="Basic object that provides the default overrides for a plugin." alt="" coords="13,79,131,104"/>
<area shape="poly" title=" " alt="" coords="75,118,75,152,69,152,69,118"/>
<area shape="rect" href="classIDobbyRdkPlugin.html" title="Interface that plugin libraries have to implement." alt="" coords="5,5,139,31"/>
<area shape="poly" title=" " alt="" coords="75,44,75,79,69,79,69,44"/>
</map>
<center><span class="legend">[<a href="graph_legend.html">legend</a>]</span></center></div>
<div class="dynheader">
Collaboration diagram for GpuPlugin:</div>
<div class="dyncontent">
<div class="center"><img src="classGpuPlugin__coll__graph.png" border="0" usemap="#aGpuPlugin_coll__map" alt="Collaboration graph"/></div>
<map name="aGpuPlugin_coll__map" id="aGpuPlugin_coll__map">
<area shape="rect" title="Dobby GPU plugin." alt="" coords="28,152,116,177"/>
<area shape="rect" href="classRdkPluginBase.html" title="Basic object that provides the default overrides for a plugin." alt="" coords="13,79,131,104"/>
<area shape="poly" title=" " alt="" coords="75,118,75,152,69,152,69,118"/>
<area shape="rect" href="classIDobbyRdkPlugin.html" title="Interface that plugin libraries have to implement." alt="" coords="5,5,139,31"/>
<area shape="poly" title=" " alt="" coords="75,44,75,79,69,79,69,44"/>
</map>
<center><span class="legend">[<a href="graph_legend.html">legend</a>]</span></center></div>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="pub-methods" name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr class="memitem:a86e04772994a73939f82dce29add369c" id="r_a86e04772994a73939f82dce29add369c"><td class="memItemLeft" align="right" valign="top"><a id="a86e04772994a73939f82dce29add369c" name="a86e04772994a73939f82dce29add369c"></a>
&#160;</td><td class="memItemRight" valign="bottom"><b>GpuPlugin</b> (std::shared_ptr&lt; rt_dobby_schema &gt; &amp;containerConfig, const std::shared_ptr&lt; <a class="el" href="classDobbyRdkPluginUtils.html">DobbyRdkPluginUtils</a> &gt; &amp;utils, const std::string &amp;rootfsPath)</td></tr>
<tr class="separator:a86e04772994a73939f82dce29add369c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abcfe03aa369ae6718bab521e0ec5a2b0" id="r_abcfe03aa369ae6718bab521e0ec5a2b0"><td class="memItemLeft" align="right" valign="top">std::string&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classGpuPlugin.html#abcfe03aa369ae6718bab521e0ec5a2b0">name</a> () const override</td></tr>
<tr class="memdesc:abcfe03aa369ae6718bab521e0ec5a2b0"><td class="mdescLeft">&#160;</td><td class="mdescRight">Should return the name of the plugin.  <br /></td></tr>
<tr class="separator:abcfe03aa369ae6718bab521e0ec5a2b0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae5d647695cc99b829fc24292ef37f1bf" id="r_ae5d647695cc99b829fc24292ef37f1bf"><td class="memItemLeft" align="right" valign="top">unsigned&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classGpuPlugin.html#ae5d647695cc99b829fc24292ef37f1bf">hookHints</a> () const override</td></tr>
<tr class="memdesc:ae5d647695cc99b829fc24292ef37f1bf"><td class="mdescLeft">&#160;</td><td class="mdescRight">Should return a bitfield of the hook points implemented by the plugin.  <br /></td></tr>
<tr class="separator:ae5d647695cc99b829fc24292ef37f1bf"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6bf193cd25f56ebed0c35c325081827f" id="r_a6bf193cd25f56ebed0c35c325081827f"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classGpuPlugin.html#a6bf193cd25f56ebed0c35c325081827f">createRuntime</a> () override</td></tr>
<tr class="memdesc:a6bf193cd25f56ebed0c35c325081827f"><td class="mdescLeft">&#160;</td><td class="mdescRight">we use the createRuntime point to create a cgroup and put the containered process into it.  <br /></td></tr>
<tr class="separator:a6bf193cd25f56ebed0c35c325081827f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0e8b9b5273ed9211a5e80cd0f3cbe34d" id="r_a0e8b9b5273ed9211a5e80cd0f3cbe34d"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classGpuPlugin.html#a0e8b9b5273ed9211a5e80cd0f3cbe34d">postStop</a> () override</td></tr>
<tr class="memdesc:a0e8b9b5273ed9211a5e80cd0f3cbe34d"><td class="mdescLeft">&#160;</td><td class="mdescRight">We use the postStop point to remove the cgroup directory created in the createRuntime phase.  <br /></td></tr>
<tr class="separator:a0e8b9b5273ed9211a5e80cd0f3cbe34d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0d7e104c74449d084c0e43223e4daca4" id="r_a0d7e104c74449d084c0e43223e4daca4"><td class="memItemLeft" align="right" valign="top">std::vector&lt; std::string &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classGpuPlugin.html#a0d7e104c74449d084c0e43223e4daca4">getDependencies</a> () const override</td></tr>
<tr class="memdesc:a0d7e104c74449d084c0e43223e4daca4"><td class="mdescLeft">&#160;</td><td class="mdescRight">Should return the names of the plugins this plugin depends on.  <br /></td></tr>
<tr class="separator:a0d7e104c74449d084c0e43223e4daca4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="inherit_header pub_methods_classRdkPluginBase"><td colspan="2" onclick="javascript:toggleInherit('pub_methods_classRdkPluginBase')"><img src="closed.png" alt="-"/>&#160;Public Member Functions inherited from <a class="el" href="classRdkPluginBase.html">RdkPluginBase</a></td></tr>
<tr class="memitem:afb8522eece4b1948ea815d12a1fdd08b inherit pub_methods_classRdkPluginBase" id="r_afb8522eece4b1948ea815d12a1fdd08b"><td class="memItemLeft" align="right" valign="top">virtual bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classRdkPluginBase.html#afb8522eece4b1948ea815d12a1fdd08b">postInstallation</a> ()</td></tr>
<tr class="separator:afb8522eece4b1948ea815d12a1fdd08b inherit pub_methods_classRdkPluginBase"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac4766784eaa83e35b83b817af85ea045 inherit pub_methods_classRdkPluginBase" id="r_ac4766784eaa83e35b83b817af85ea045"><td class="memItemLeft" align="right" valign="top">virtual bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classRdkPluginBase.html#ac4766784eaa83e35b83b817af85ea045">preCreation</a> ()</td></tr>
<tr class="separator:ac4766784eaa83e35b83b817af85ea045 inherit pub_methods_classRdkPluginBase"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:adccac3990feeac6d14bb4b32fafe50b7 inherit pub_methods_classRdkPluginBase" id="r_adccac3990feeac6d14bb4b32fafe50b7"><td class="memItemLeft" align="right" valign="top">virtual bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classRdkPluginBase.html#adccac3990feeac6d14bb4b32fafe50b7">createContainer</a> ()</td></tr>
<tr class="separator:adccac3990feeac6d14bb4b32fafe50b7 inherit pub_methods_classRdkPluginBase"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af2e1681da85f73cbe1ea59325ec5c651 inherit pub_methods_classRdkPluginBase" id="r_af2e1681da85f73cbe1ea59325ec5c651"><td class="memItemLeft" align="right" valign="top">virtual bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classRdkPluginBase.html#af2e1681da85f73cbe1ea59325ec5c651">postStart</a> ()</td></tr>
<tr class="separator:af2e1681da85f73cbe1ea59325ec5c651 inherit pub_methods_classRdkPluginBase"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a690f2542922c5c88a9ff4654732fea99 inherit pub_methods_classRdkPluginBase" id="r_a690f2542922c5c88a9ff4654732fea99"><td class="memItemLeft" align="right" valign="top">virtual bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classRdkPluginBase.html#a690f2542922c5c88a9ff4654732fea99">postHalt</a> ()</td></tr>
<tr class="separator:a690f2542922c5c88a9ff4654732fea99 inherit pub_methods_classRdkPluginBase"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7575fc87a940eedb30d68d435cddbf87 inherit pub_methods_classRdkPluginBase" id="r_a7575fc87a940eedb30d68d435cddbf87"><td class="memItemLeft" align="right" valign="top">std::vector&lt; std::string &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classRdkPluginBase.html#a7575fc87a940eedb30d68d435cddbf87">getDependencies</a> () const override</td></tr>
<tr class="memdesc:a7575fc87a940eedb30d68d435cddbf87 inherit pub_methods_classRdkPluginBase"><td class="mdescLeft">&#160;</td><td class="mdescRight">Should return the names of the plugins this plugin depends on.  <br /></td></tr>
<tr class="separator:a7575fc87a940eedb30d68d435cddbf87 inherit pub_methods_classRdkPluginBase"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="pri-methods" name="pri-methods"></a>
Private Member Functions</h2></td></tr>
<tr class="memitem:a5686ef524f81d23baffb7003a42a5c1e" id="r_a5686ef524f81d23baffb7003a42a5c1e"><td class="memItemLeft" align="right" valign="top">std::string&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classGpuPlugin.html#a5686ef524f81d23baffb7003a42a5c1e">getGpuCgroupMountPoint</a> ()</td></tr>
<tr class="memdesc:a5686ef524f81d23baffb7003a42a5c1e"><td class="mdescLeft">&#160;</td><td class="mdescRight">Attempts to get the mount point of the gpu cgroup filesystem.  <br /></td></tr>
<tr class="separator:a5686ef524f81d23baffb7003a42a5c1e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a66bab618561c94dc4bb094e1815d1e4d" id="r_a66bab618561c94dc4bb094e1815d1e4d"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classGpuPlugin.html#a66bab618561c94dc4bb094e1815d1e4d">setupContainerGpuLimit</a> (const std::string cgroupDirPath, pid_t containerPid, int memoryLimit)</td></tr>
<tr class="memdesc:a66bab618561c94dc4bb094e1815d1e4d"><td class="mdescLeft">&#160;</td><td class="mdescRight">Creates a gpu cgroup for the container and moves the container into it.  <br /></td></tr>
<tr class="separator:a66bab618561c94dc4bb094e1815d1e4d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac00cceb9f0a3d92ae3b3a6daeecbeb9f" id="r_ac00cceb9f0a3d92ae3b3a6daeecbeb9f"><td class="memItemLeft" align="right" valign="top"><a id="ac00cceb9f0a3d92ae3b3a6daeecbeb9f" name="ac00cceb9f0a3d92ae3b3a6daeecbeb9f"></a>
bool&#160;</td><td class="memItemRight" valign="bottom"><b>bindMountGpuCgroup</b> (const std::string &amp;source, const std::string &amp;target)</td></tr>
<tr class="separator:ac00cceb9f0a3d92ae3b3a6daeecbeb9f"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="pri-attribs" name="pri-attribs"></a>
Private Attributes</h2></td></tr>
<tr class="memitem:aa0a45d9141af07636332ec2486d3060f" id="r_aa0a45d9141af07636332ec2486d3060f"><td class="memItemLeft" align="right" valign="top"><a id="aa0a45d9141af07636332ec2486d3060f" name="aa0a45d9141af07636332ec2486d3060f"></a>
const std::string&#160;</td><td class="memItemRight" valign="bottom"><b>mName</b></td></tr>
<tr class="separator:aa0a45d9141af07636332ec2486d3060f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a43db97a2a74f00f8efd5c46b51b058d4" id="r_a43db97a2a74f00f8efd5c46b51b058d4"><td class="memItemLeft" align="right" valign="top"><a id="a43db97a2a74f00f8efd5c46b51b058d4" name="a43db97a2a74f00f8efd5c46b51b058d4"></a>
std::shared_ptr&lt; rt_dobby_schema &gt;&#160;</td><td class="memItemRight" valign="bottom"><b>mContainerConfig</b></td></tr>
<tr class="separator:a43db97a2a74f00f8efd5c46b51b058d4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4532419e319f1ba08c6ac4eea2003ed4" id="r_a4532419e319f1ba08c6ac4eea2003ed4"><td class="memItemLeft" align="right" valign="top"><a id="a4532419e319f1ba08c6ac4eea2003ed4" name="a4532419e319f1ba08c6ac4eea2003ed4"></a>
const std::shared_ptr&lt; <a class="el" href="classDobbyRdkPluginUtils.html">DobbyRdkPluginUtils</a> &gt;&#160;</td><td class="memItemRight" valign="bottom"><b>mUtils</b></td></tr>
<tr class="separator:a4532419e319f1ba08c6ac4eea2003ed4"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="inherited" name="inherited"></a>
Additional Inherited Members</h2></td></tr>
<tr class="inherit_header pub_types_classIDobbyRdkPlugin"><td colspan="2" onclick="javascript:toggleInherit('pub_types_classIDobbyRdkPlugin')"><img src="closed.png" alt="-"/>&#160;Public Types inherited from <a class="el" href="classIDobbyRdkPlugin.html">IDobbyRdkPlugin</a></td></tr>
<tr class="memitem:a2d3635518c5ee88a5d3fb8c9acdc0e8f inherit pub_types_classIDobbyRdkPlugin" id="r_a2d3635518c5ee88a5d3fb8c9acdc0e8f"><td class="memItemLeft" align="right" valign="top">enum &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classIDobbyRdkPlugin.html#a2d3635518c5ee88a5d3fb8c9acdc0e8f">HintFlags</a> : unsigned { <br />
&#160;&#160;<b>PostInstallationFlag</b> = (1 &lt;&lt; 0)
, <b>PreCreationFlag</b> = (1 &lt;&lt; 1)
, <b>CreateRuntimeFlag</b> = (1 &lt;&lt; 2)
, <b>CreateContainerFlag</b> = (1 &lt;&lt; 3)
, <br />
&#160;&#160;<b>PostStartFlag</b> = (1 &lt;&lt; 5)
, <b>PostHaltFlag</b> = (1 &lt;&lt; 6)
, <b>PostStopFlag</b> = (1 &lt;&lt; 7)
, <b>Unknown</b> = 0
<br />
 }</td></tr>
<tr class="memdesc:a2d3635518c5ee88a5d3fb8c9acdc0e8f"><td class="mdescLeft">&#160;</td><td class="mdescRight">Bit flags that should be returned by hookHints.  <a href="classIDobbyRdkPlugin.html#a2d3635518c5ee88a5d3fb8c9acdc0e8f">More...</a><br /></td></tr>
<tr class="separator:a2d3635518c5ee88a5d3fb8c9acdc0e8f inherit pub_types_classIDobbyRdkPlugin"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p><a class="el" href="classDobby.html" title="The root Dobby object, runs the dbus loop.">Dobby</a> GPU plugin. </p>
<p>Sets the gpu memory limits for a given container.</p>
<p>This plugin simply creates a gpu cgroup for the container, sets the limit and then moves the containered process into it.</p>
<p>This is effectively what crun does for all the other limits, but it doesn't know about the custom gpu cgroup as that is an extension to the default cgroups. </p>
</div><h2 class="groupheader">Member Function Documentation</h2>
<a id="a6bf193cd25f56ebed0c35c325081827f" name="a6bf193cd25f56ebed0c35c325081827f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6bf193cd25f56ebed0c35c325081827f">&#9670;&#160;</a></span>createRuntime()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">bool GpuPlugin::createRuntime </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">override</span><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>we use the createRuntime point to create a cgroup and put the containered process into it. </p>
<p>The amount of memory to assign is read from the plugin's data section in the bundle config.</p>
<p>The cgroup is given the same name as the container.</p>
<dl class="section return"><dt>Returns</dt><dd>true if successful, otherwise false. </dd></dl>

<p>Reimplemented from <a class="el" href="classRdkPluginBase.html#af00763b74d9b809a46bbf025e485d010">RdkPluginBase</a>.</p>

</div>
</div>
<a id="a0d7e104c74449d084c0e43223e4daca4" name="a0d7e104c74449d084c0e43223e4daca4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0d7e104c74449d084c0e43223e4daca4">&#9670;&#160;</a></span>getDependencies()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::vector&lt; std::string &gt; GpuPlugin::getDependencies </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">override</span><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Should return the names of the plugins this plugin depends on. </p>
<p>This can be used to determine the order in which the plugins should be processed when running hooks.</p>
<dl class="section return"><dt>Returns</dt><dd>Names of the plugins this plugin depends on. </dd></dl>

<p>Implements <a class="el" href="classIDobbyRdkPlugin.html#a35af3a4dc5668f48cef268e1bd619110">IDobbyRdkPlugin</a>.</p>

</div>
</div>
<a id="a5686ef524f81d23baffb7003a42a5c1e" name="a5686ef524f81d23baffb7003a42a5c1e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5686ef524f81d23baffb7003a42a5c1e">&#9670;&#160;</a></span>getGpuCgroupMountPoint()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::string GpuPlugin::getGpuCgroupMountPoint </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Attempts to get the mount point of the gpu cgroup filesystem. </p>
<p>This scans the mount table looking for the cgroups mount, if this fails it's pretty fatal.</p>
<p>This is typically "/sys/fs/cgroup/gpu".</p>
<dl class="section return"><dt>Returns</dt><dd>a string to the gpu cgroup path. </dd></dl>

</div>
</div>
<a id="ae5d647695cc99b829fc24292ef37f1bf" name="ae5d647695cc99b829fc24292ef37f1bf"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae5d647695cc99b829fc24292ef37f1bf">&#9670;&#160;</a></span>hookHints()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">unsigned GpuPlugin::hookHints </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">override</span><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Should return a bitfield of the hook points implemented by the plugin. </p>
<p>Only bits that are set will be called as hooks. This is to optimise the implementation of the hook code to ensure we don't waste time trying to run hooks that don't do anything</p>
<p>The value returned should be constant for the lifetime of the class</p>
<dl class="section return"><dt>Returns</dt><dd>bitmask of the HintFlags bits. </dd></dl>

<p>Implements <a class="el" href="classIDobbyRdkPlugin.html#aff3382d4f6fcb0e517b1c5e39efc7a59">IDobbyRdkPlugin</a>.</p>

</div>
</div>
<a id="abcfe03aa369ae6718bab521e0ec5a2b0" name="abcfe03aa369ae6718bab521e0ec5a2b0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#abcfe03aa369ae6718bab521e0ec5a2b0">&#9670;&#160;</a></span>name()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::string GpuPlugin::name </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">override</span><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Should return the name of the plugin. </p>
<dl class="section return"><dt>Returns</dt><dd>string with the name of the hook. </dd></dl>

<p>Implements <a class="el" href="classIDobbyRdkPlugin.html#a9c41f1227b331ccec63e7a3c11534e83">IDobbyRdkPlugin</a>.</p>

</div>
</div>
<a id="a0e8b9b5273ed9211a5e80cd0f3cbe34d" name="a0e8b9b5273ed9211a5e80cd0f3cbe34d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0e8b9b5273ed9211a5e80cd0f3cbe34d">&#9670;&#160;</a></span>postStop()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">bool GpuPlugin::postStop </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">override</span><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>We use the postStop point to remove the cgroup directory created in the createRuntime phase. </p>
<p>The directory will have the same name as the container id.</p>
<dl class="section return"><dt>Returns</dt><dd>true if successful, otherwise false. </dd></dl>

<p>Reimplemented from <a class="el" href="classRdkPluginBase.html#a5f6d9df3768beed63fe0361af3bb050c">RdkPluginBase</a>.</p>

</div>
</div>
<a id="a66bab618561c94dc4bb094e1815d1e4d" name="a66bab618561c94dc4bb094e1815d1e4d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a66bab618561c94dc4bb094e1815d1e4d">&#9670;&#160;</a></span>setupContainerGpuLimit()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">bool GpuPlugin::setupContainerGpuLimit </td>
          <td>(</td>
          <td class="paramtype">const std::string&#160;</td>
          <td class="paramname"><em>cgroupDirPath</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">pid_t&#160;</td>
          <td class="paramname"><em>containerPid</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>memoryLimit</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Creates a gpu cgroup for the container and moves the container into it. </p>
<p>The cgroup is given the same name as the container.</p>
<dl class="section warning"><dt>Warning</dt><dd>This requires a version of crun with the following PR: <a href="https://github.com/containers/crun/pull/609">https://github.com/containers/crun/pull/609</a> to ensure cgroup controllers are correctly mounted. Without the PR applied, the GPU cgroup is mounted incorrectly, see <a href="https://github.com/containers/crun/issues/625">https://github.com/containers/crun/issues/625</a> for more info</dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">cgroupDirPath</td><td>Path to the gpu cgroup directory. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">containerPid</td><td>The pid of the process in the container. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">memoryLimit</td><td>The memory limit set in the bundle config.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>true if successful, otherwise false. </dd></dl>

</div>
</div>
<hr/>The documentation for this class was generated from the following files:<ul>
<li>rdkPlugins/GPU/source/<a class="el" href="GpuPlugin_8h_source.html">GpuPlugin.h</a></li>
<li>rdkPlugins/GPU/source/<b>GpuPlugin.cpp</b></li>
</ul>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.8
</small></address>
</body>
</html>
