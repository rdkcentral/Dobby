<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.9.1"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Dobby: DobbyRunC Class Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Dobby
   &#160;<span id="projectnumber">3.0</span>
   </div>
   <div id="projectbrief">Dobby “Docker based Thingy” is a tool for managing and running OCI containers using crun</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.1 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#nested-classes">Classes</a> &#124;
<a href="#pub-types">Public Types</a> &#124;
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="#pri-methods">Private Member Functions</a> &#124;
<a href="#pri-attribs">Private Attributes</a> &#124;
<a href="classDobbyRunC-members.html">List of all members</a>  </div>
  <div class="headertitle">
<div class="title">DobbyRunC Class Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>Wrapper around the runc command line app.  
 <a href="classDobbyRunC.html#details">More...</a></p>

<p><code>#include &lt;<a class="el" href="DobbyRunC_8h_source.html">DobbyRunC.h</a>&gt;</code></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="nested-classes"></a>
Classes</h2></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structDobbyRunC_1_1ContainerListItem.html">ContainerListItem</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-types"></a>
Public Types</h2></td></tr>
<tr class="memitem:afad0ba02323c06a39e1343533d2bf5b0"><td class="memItemLeft" align="right" valign="top"><a id="afad0ba02323c06a39e1343533d2bf5b0"></a>enum class &#160;</td><td class="memItemRight" valign="bottom"><b>ContainerStatus</b> { <br />
&#160;&#160;<b>Unknown</b>
, <b>Created</b>
, <b>Running</b>
, <b>Pausing</b>
, <br />
&#160;&#160;<b>Paused</b>
, <b>Stopped</b>
<br />
 }</td></tr>
<tr class="separator:afad0ba02323c06a39e1343533d2bf5b0"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr class="memitem:a593ddded678131b12ca9083807802f39"><td class="memItemLeft" align="right" valign="top"><a id="a593ddded678131b12ca9083807802f39"></a>
&#160;</td><td class="memItemRight" valign="bottom"><b>DobbyRunC</b> (const std::shared_ptr&lt; <a class="el" href="classIDobbyUtils__v3.html">IDobbyUtils</a> &gt; &amp;utils, const std::shared_ptr&lt; const <a class="el" href="classIDobbySettings.html">IDobbySettings</a> &gt; &amp;settings)</td></tr>
<tr class="separator:a593ddded678131b12ca9083807802f39"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9e5cdaef2fe100fa18f291c9cb809723"><td class="memItemLeft" align="right" valign="top">std::pair&lt; pid_t, pid_t &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classDobbyRunC.html#a9e5cdaef2fe100fa18f291c9cb809723">create</a> (const <a class="el" href="classContainerId.html">ContainerId</a> &amp;id, const std::shared_ptr&lt; const <a class="el" href="classDobbyBundle.html">DobbyBundle</a> &gt; &amp;bundle, const std::shared_ptr&lt; const <a class="el" href="classIDobbyStream.html">IDobbyStream</a> &gt; &amp;console, const std::list&lt; int &gt; &amp;files=std::list&lt; int &gt;(), const std::string &amp;customConfigPath=&quot;&quot;) const</td></tr>
<tr class="memdesc:a9e5cdaef2fe100fa18f291c9cb809723"><td class="mdescLeft">&#160;</td><td class="mdescRight">Creates the container but doesn't start the init process.  <a href="classDobbyRunC.html#a9e5cdaef2fe100fa18f291c9cb809723">More...</a><br /></td></tr>
<tr class="separator:a9e5cdaef2fe100fa18f291c9cb809723"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a061a2f219117f2545b32848b30fda254"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classDobbyRunC.html#a061a2f219117f2545b32848b30fda254">destroy</a> (const <a class="el" href="classContainerId.html">ContainerId</a> &amp;id, const std::shared_ptr&lt; const <a class="el" href="classIDobbyStream.html">IDobbyStream</a> &gt; &amp;console, bool force=false) const</td></tr>
<tr class="memdesc:a061a2f219117f2545b32848b30fda254"><td class="mdescLeft">&#160;</td><td class="mdescRight">Runs the runc command line tool with the 'delete' command.  <a href="classDobbyRunC.html#a061a2f219117f2545b32848b30fda254">More...</a><br /></td></tr>
<tr class="separator:a061a2f219117f2545b32848b30fda254"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a42581f202bddd15bca1166a164984510"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classDobbyRunC.html#a42581f202bddd15bca1166a164984510">start</a> (const <a class="el" href="classContainerId.html">ContainerId</a> &amp;id, const std::shared_ptr&lt; const <a class="el" href="classIDobbyStream.html">IDobbyStream</a> &gt; &amp;console) const</td></tr>
<tr class="memdesc:a42581f202bddd15bca1166a164984510"><td class="mdescLeft">&#160;</td><td class="mdescRight">Starts a container created with <em>create</em> command.  <a href="classDobbyRunC.html#a42581f202bddd15bca1166a164984510">More...</a><br /></td></tr>
<tr class="separator:a42581f202bddd15bca1166a164984510"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2215bee2d785483c5225671b24beada3"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classDobbyRunC.html#a2215bee2d785483c5225671b24beada3">killCont</a> (const <a class="el" href="classContainerId.html">ContainerId</a> &amp;id, int signal, bool all=false) const</td></tr>
<tr class="memdesc:a2215bee2d785483c5225671b24beada3"><td class="mdescLeft">&#160;</td><td class="mdescRight">Runs the runc command line tool with the 'kill' command.  <a href="classDobbyRunC.html#a2215bee2d785483c5225671b24beada3">More...</a><br /></td></tr>
<tr class="separator:a2215bee2d785483c5225671b24beada3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9786887de4f52b7ca793d378f97e77e5"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classDobbyRunC.html#a9786887de4f52b7ca793d378f97e77e5">pause</a> (const <a class="el" href="classContainerId.html">ContainerId</a> &amp;id) const</td></tr>
<tr class="memdesc:a9786887de4f52b7ca793d378f97e77e5"><td class="mdescLeft">&#160;</td><td class="mdescRight">Runs the runc command line tool with the 'pause' command.  <a href="classDobbyRunC.html#a9786887de4f52b7ca793d378f97e77e5">More...</a><br /></td></tr>
<tr class="separator:a9786887de4f52b7ca793d378f97e77e5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab4353e59e4db26bad9d48bb59de3f1fe"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classDobbyRunC.html#ab4353e59e4db26bad9d48bb59de3f1fe">resume</a> (const <a class="el" href="classContainerId.html">ContainerId</a> &amp;id) const</td></tr>
<tr class="memdesc:ab4353e59e4db26bad9d48bb59de3f1fe"><td class="mdescLeft">&#160;</td><td class="mdescRight">Runs the runc command line tool with the 'resume' command.  <a href="classDobbyRunC.html#ab4353e59e4db26bad9d48bb59de3f1fe">More...</a><br /></td></tr>
<tr class="separator:ab4353e59e4db26bad9d48bb59de3f1fe"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac126f92e4fff7226ccf309977b8932df"><td class="memItemLeft" align="right" valign="top">std::pair&lt; pid_t, pid_t &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classDobbyRunC.html#ac126f92e4fff7226ccf309977b8932df">exec</a> (const <a class="el" href="classContainerId.html">ContainerId</a> &amp;id, const std::string &amp;options, const std::string &amp;command) const</td></tr>
<tr class="memdesc:ac126f92e4fff7226ccf309977b8932df"><td class="mdescLeft">&#160;</td><td class="mdescRight">Runs the crun command line tool with the 'exec' command.  <a href="classDobbyRunC.html#ac126f92e4fff7226ccf309977b8932df">More...</a><br /></td></tr>
<tr class="separator:ac126f92e4fff7226ccf309977b8932df"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8e10ced10e2ddd397379a4a93468085d"><td class="memItemLeft" align="right" valign="top">ContainerStatus&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classDobbyRunC.html#a8e10ced10e2ddd397379a4a93468085d">state</a> (const <a class="el" href="classContainerId.html">ContainerId</a> &amp;id) const</td></tr>
<tr class="memdesc:a8e10ced10e2ddd397379a4a93468085d"><td class="mdescLeft">&#160;</td><td class="mdescRight">Runs the runc command line tool with the 'state' command.  <a href="classDobbyRunC.html#a8e10ced10e2ddd397379a4a93468085d">More...</a><br /></td></tr>
<tr class="separator:a8e10ced10e2ddd397379a4a93468085d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a386478adb4467dc95c108e9e1c155f00"><td class="memItemLeft" align="right" valign="top">std::list&lt; <a class="el" href="structDobbyRunC_1_1ContainerListItem.html">ContainerListItem</a> &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classDobbyRunC.html#a386478adb4467dc95c108e9e1c155f00">list</a> () const</td></tr>
<tr class="memdesc:a386478adb4467dc95c108e9e1c155f00"><td class="mdescLeft">&#160;</td><td class="mdescRight">Runs the runc command line tool with the 'list' command.  <a href="classDobbyRunC.html#a386478adb4467dc95c108e9e1c155f00">More...</a><br /></td></tr>
<tr class="separator:a386478adb4467dc95c108e9e1c155f00"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afddb9167812aa2aca4318660e635b3b3"><td class="memItemLeft" align="right" valign="top">pid_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classDobbyRunC.html#afddb9167812aa2aca4318660e635b3b3">run</a> (const <a class="el" href="classContainerId.html">ContainerId</a> &amp;id, const std::shared_ptr&lt; const <a class="el" href="classDobbyBundle.html">DobbyBundle</a> &gt; &amp;bundle, const std::shared_ptr&lt; const <a class="el" href="classIDobbyStream.html">IDobbyStream</a> &gt; &amp;console, const std::list&lt; int &gt; &amp;files=std::list&lt; int &gt;()) const</td></tr>
<tr class="memdesc:afddb9167812aa2aca4318660e635b3b3"><td class="mdescLeft">&#160;</td><td class="mdescRight">Runs the runc command line tool with the 'run' command.  <a href="classDobbyRunC.html#afddb9167812aa2aca4318660e635b3b3">More...</a><br /></td></tr>
<tr class="separator:afddb9167812aa2aca4318660e635b3b3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a39c087c63547fe4efe9ef99a6d33967d"><td class="memItemLeft" align="right" valign="top"><a id="a39c087c63547fe4efe9ef99a6d33967d"></a>
const std::string&#160;</td><td class="memItemRight" valign="bottom"><b>getWorkingDir</b> () const</td></tr>
<tr class="separator:a39c087c63547fe4efe9ef99a6d33967d"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pri-methods"></a>
Private Member Functions</h2></td></tr>
<tr class="memitem:a9966d759b5b584c895001c1e9714df2e"><td class="memItemLeft" align="right" valign="top">pid_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classDobbyRunC.html#a9966d759b5b584c895001c1e9714df2e">forkExecRunC</a> (const std::vector&lt; const char * &gt; &amp;args, const std::initializer_list&lt; const char * &gt; &amp;envs, const std::list&lt; int &gt; &amp;files=std::list&lt; int &gt;(), const std::shared_ptr&lt; const <a class="el" href="classIDobbyStream.html">IDobbyStream</a> &gt; &amp;stdoutStream=nullptr, const std::shared_ptr&lt; const <a class="el" href="classIDobbyStream.html">IDobbyStream</a> &gt; &amp;stderrStream=nullptr) const</td></tr>
<tr class="memdesc:a9966d759b5b584c895001c1e9714df2e"><td class="mdescLeft">&#160;</td><td class="mdescRight">Performs a fork then exec of the runC binary with the supplied args.  <a href="classDobbyRunC.html#a9966d759b5b584c895001c1e9714df2e">More...</a><br /></td></tr>
<tr class="separator:a9966d759b5b584c895001c1e9714df2e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a728d384bd10625de282e15eb8c4b8210"><td class="memItemLeft" align="right" valign="top">pid_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classDobbyRunC.html#a728d384bd10625de282e15eb8c4b8210">readPidFile</a> (const std::string pidFilePath) const</td></tr>
<tr class="memdesc:a728d384bd10625de282e15eb8c4b8210"><td class="mdescLeft">&#160;</td><td class="mdescRight">Reads file with pid of the container and converts it into pid_t type variable.  <a href="classDobbyRunC.html#a728d384bd10625de282e15eb8c4b8210">More...</a><br /></td></tr>
<tr class="separator:a728d384bd10625de282e15eb8c4b8210"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af4048c712e0b231d8e539fd798b7050c"><td class="memItemLeft" align="right" valign="top">ContainerStatus&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classDobbyRunC.html#af4048c712e0b231d8e539fd798b7050c">getContainerStatusFromJson</a> (const Json::Value &amp;<a class="el" href="classDobbyRunC.html#a8e10ced10e2ddd397379a4a93468085d">state</a>) const</td></tr>
<tr class="memdesc:af4048c712e0b231d8e539fd798b7050c"><td class="mdescLeft">&#160;</td><td class="mdescRight">Gets the container status from the json object.  <a href="classDobbyRunC.html#af4048c712e0b231d8e539fd798b7050c">More...</a><br /></td></tr>
<tr class="separator:af4048c712e0b231d8e539fd798b7050c"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pri-attribs"></a>
Private Attributes</h2></td></tr>
<tr class="memitem:a6d6c37415f1723ac6e363eeaa61aa3bd"><td class="memItemLeft" align="right" valign="top"><a id="a6d6c37415f1723ac6e363eeaa61aa3bd"></a>
const std::shared_ptr&lt; <a class="el" href="classIDobbyUtils__v3.html">IDobbyUtils</a> &gt;&#160;</td><td class="memItemRight" valign="bottom"><b>mUtilities</b></td></tr>
<tr class="separator:a6d6c37415f1723ac6e363eeaa61aa3bd"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a78a11a441ce20f983c8fbea56920fb7f"><td class="memItemLeft" align="right" valign="top"><a id="a78a11a441ce20f983c8fbea56920fb7f"></a>
const std::string&#160;</td><td class="memItemRight" valign="bottom"><b>mRuncPath</b></td></tr>
<tr class="separator:a78a11a441ce20f983c8fbea56920fb7f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aecff2c774f87382c8b3c6800ebdc5d23"><td class="memItemLeft" align="right" valign="top"><a id="aecff2c774f87382c8b3c6800ebdc5d23"></a>
const std::string&#160;</td><td class="memItemRight" valign="bottom"><b>mWorkingDir</b></td></tr>
<tr class="separator:aecff2c774f87382c8b3c6800ebdc5d23"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6e3790205167a124ac036b9cbea059a7"><td class="memItemLeft" align="right" valign="top"><a id="a6e3790205167a124ac036b9cbea059a7"></a>
const std::string&#160;</td><td class="memItemRight" valign="bottom"><b>mLogDir</b></td></tr>
<tr class="separator:a6e3790205167a124ac036b9cbea059a7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4ac882f040f5d1b5e105343df0a64d8b"><td class="memItemLeft" align="right" valign="top"><a id="a4ac882f040f5d1b5e105343df0a64d8b"></a>
const std::string&#160;</td><td class="memItemRight" valign="bottom"><b>mLogFilePath</b></td></tr>
<tr class="separator:a4ac882f040f5d1b5e105343df0a64d8b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7b7d62d5985a400042cab3507a00e2fd"><td class="memItemLeft" align="right" valign="top"><a id="a7b7d62d5985a400042cab3507a00e2fd"></a>
const std::string&#160;</td><td class="memItemRight" valign="bottom"><b>mConsoleSocket</b></td></tr>
<tr class="separator:a7b7d62d5985a400042cab3507a00e2fd"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Wrapper around the runc command line app. </p>
<p>This class just formats the args and environment variables to give the runc command line app, which we launch with a fork/exec. </p>
</div><h2 class="groupheader">Member Function Documentation</h2>
<a id="a9e5cdaef2fe100fa18f291c9cb809723"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9e5cdaef2fe100fa18f291c9cb809723">&#9670;&nbsp;</a></span>create()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">std::pair&lt; pid_t, pid_t &gt; DobbyRunC::create </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classContainerId.html">ContainerId</a> &amp;&#160;</td>
          <td class="paramname"><em>id</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::shared_ptr&lt; const <a class="el" href="classDobbyBundle.html">DobbyBundle</a> &gt; &amp;&#160;</td>
          <td class="paramname"><em>bundle</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::shared_ptr&lt; const <a class="el" href="classIDobbyStream.html">IDobbyStream</a> &gt; &amp;&#160;</td>
          <td class="paramname"><em>console</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::list&lt; int &gt; &amp;&#160;</td>
          <td class="paramname"><em>files</em> = <code>std::list&lt;int&gt;()</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::string &amp;&#160;</td>
          <td class="paramname"><em>customConfigPath</em> = <code>&quot;&quot;</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Creates the container but doesn't start the init process. </p>
<p>This is equivalent to calling the following on the command line /usr/sbin/runc create &ndash;bundle &lt;dir&gt; &lt;id&gt;</p>
<p>The pid of the runc tool is returned, this will survive until the container is destroyed. A watch should be placed on the pid to determine when it quits and this is the point the container is destroyed.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">id</td><td>The id / name of the container to create </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">bundle</td><td>The bundle directory to pass to the runc tool </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">console</td><td>The stream to attach to the stdout / stderr of the runc tool. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">files</td><td>A list of file descriptors to pass into the container. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">customConfigPath</td><td>Path to a different config.json file to use instead of the one in the bundle</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Pair of PIDs. First PID is the PID of the crun process, used to match the launched process to the logging connection. Second PID is the contents of the container pidfile and is the actual PID of the container </dd></dl>

</div>
</div>
<a id="a061a2f219117f2545b32848b30fda254"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a061a2f219117f2545b32848b30fda254">&#9670;&nbsp;</a></span>destroy()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool DobbyRunC::destroy </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classContainerId.html">ContainerId</a> &amp;&#160;</td>
          <td class="paramname"><em>id</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::shared_ptr&lt; const <a class="el" href="classIDobbyStream.html">IDobbyStream</a> &gt; &amp;&#160;</td>
          <td class="paramname"><em>console</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>force</em> = <code>false</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Runs the runc command line tool with the 'delete' command. </p>
<p>This is equivalent to calling the following on the command line </p><pre class="fragment">/usr/sbin/runc delete &lt;id&gt;
</pre><p> This command will delete any cruft that the runc tool has left behind, things like cgroups, log and or pid files, etc.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">id</td><td>The id / name of the container to create.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>true or false based on the return code of the runc tool. </dd></dl>

</div>
</div>
<a id="ac126f92e4fff7226ccf309977b8932df"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac126f92e4fff7226ccf309977b8932df">&#9670;&nbsp;</a></span>exec()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">std::pair&lt; pid_t, pid_t &gt; DobbyRunC::exec </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classContainerId.html">ContainerId</a> &amp;&#160;</td>
          <td class="paramname"><em>id</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::string &amp;&#160;</td>
          <td class="paramname"><em>options</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::string &amp;&#160;</td>
          <td class="paramname"><em>command</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Runs the crun command line tool with the 'exec' command. </p>
<p>This is equivalent to calling the following on the command line </p><pre class="fragment">/usr/sbin/crun exec [options...] --detach &lt;id&gt; &lt;command&gt;
</pre><p> The exec is run with the &ndash;detach option enabled so we're not stuck waiting for the command to finish execution.</p>
<p>TODO:: Fix bug where <a class="el" href="classDobby.html" title="The root Dobby object, runs the dbus loop.">Dobby</a> does not correctly detect when container exits after running exec due to zombie process issue</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">id</td><td>The id / name of the container to execute the command in. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">options</td><td>The options to execute the command with. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">command</td><td>The command to execute.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Pair of PIDs. First PID is the PID of the crun process, used to match the launched process to the logging connection. Second PID is the PID of the newly launched process </dd></dl>

</div>
</div>
<a id="a9966d759b5b584c895001c1e9714df2e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9966d759b5b584c895001c1e9714df2e">&#9670;&nbsp;</a></span>forkExecRunC()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">pid_t DobbyRunC::forkExecRunC </td>
          <td>(</td>
          <td class="paramtype">const std::vector&lt; const char * &gt; &amp;&#160;</td>
          <td class="paramname"><em>args</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::initializer_list&lt; const char * &gt; &amp;&#160;</td>
          <td class="paramname"><em>envs</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::list&lt; int &gt; &amp;&#160;</td>
          <td class="paramname"><em>files</em> = <code>std::list&lt;int&gt;()</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::shared_ptr&lt; const <a class="el" href="classIDobbyStream.html">IDobbyStream</a> &gt; &amp;&#160;</td>
          <td class="paramname"><em>stdoutStream</em> = <code>nullptr</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::shared_ptr&lt; const <a class="el" href="classIDobbyStream.html">IDobbyStream</a> &gt; &amp;&#160;</td>
          <td class="paramname"><em>stderrStream</em> = <code>nullptr</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Performs a fork then exec of the runC binary with the supplied args. </p>
<p>This function blocks until the runC process has finished, then it returns the integer result.</p>
<p>stdin is redirected to /dev/null before the exec. If a stdoutStream or stderrStream arguments are supplied then the stdout/stderr output will be written into the supplied streams, otherwise they'll also be redirected to /dev/null. </p>

</div>
</div>
<a id="af4048c712e0b231d8e539fd798b7050c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af4048c712e0b231d8e539fd798b7050c">&#9670;&nbsp;</a></span>getContainerStatusFromJson()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">DobbyRunC::ContainerStatus DobbyRunC::getContainerStatusFromJson </td>
          <td>(</td>
          <td class="paramtype">const Json::Value &amp;&#160;</td>
          <td class="paramname"><em>state</em></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Gets the container status from the json object. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">state</td><td>Json object containing the container state.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>the container state, or ContainerStatus::Unknown. </dd></dl>

</div>
</div>
<a id="a2215bee2d785483c5225671b24beada3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2215bee2d785483c5225671b24beada3">&#9670;&nbsp;</a></span>killCont()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool DobbyRunC::killCont </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classContainerId.html">ContainerId</a> &amp;&#160;</td>
          <td class="paramname"><em>id</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>signal</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>all</em> = <code>false</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Runs the runc command line tool with the 'kill' command. </p>
<p>This is equivalent to calling the following on the command line /usr/sbin/runc kill &lt;id&gt; &lt;signal&gt;</p>
<p>We only support the following signals; SIGTERM, SIGKILL, SIGUSR1, SIGUSR2 &amp; SIGUSR2.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">id</td><td>The id / name of the container to create. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">signal</td><td>The signal number to send.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>true or false based on the return code of the runc tool. </dd></dl>

</div>
</div>
<a id="a386478adb4467dc95c108e9e1c155f00"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a386478adb4467dc95c108e9e1c155f00">&#9670;&nbsp;</a></span>list()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">std::list&lt; <a class="el" href="structDobbyRunC_1_1ContainerListItem.html">DobbyRunC::ContainerListItem</a> &gt; DobbyRunC::list </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Runs the runc command line tool with the 'list' command. </p>
<p>This is equivalent to calling the following on the command line </p><pre class="fragment">/usr/sbin/runc list
</pre><p> We use the json formatted response for easy parsing of the container data.</p>
<dl class="section return"><dt>Returns</dt><dd>A map of current container ids and their status. </dd></dl>

</div>
</div>
<a id="a9786887de4f52b7ca793d378f97e77e5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9786887de4f52b7ca793d378f97e77e5">&#9670;&nbsp;</a></span>pause()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool DobbyRunC::pause </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classContainerId.html">ContainerId</a> &amp;&#160;</td>
          <td class="paramname"><em>id</em></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Runs the runc command line tool with the 'pause' command. </p>
<p>This is equivalent to calling the following on the command line: </p><pre class="fragment">/usr/sbin/runc pause &lt;id&gt;
</pre> <dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">id</td><td>The id / name of the container to pause.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>true or false based on the return code of the runc tool. </dd></dl>

</div>
</div>
<a id="a728d384bd10625de282e15eb8c4b8210"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a728d384bd10625de282e15eb8c4b8210">&#9670;&nbsp;</a></span>readPidFile()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">pid_t DobbyRunC::readPidFile </td>
          <td>(</td>
          <td class="paramtype">const std::string&#160;</td>
          <td class="paramname"><em>pidFilePath</em></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Reads file with pid of the container and converts it into pid_t type variable. </p>
<dl class="section return"><dt>Returns</dt><dd>container pid, -1 if failed </dd></dl>

</div>
</div>
<a id="ab4353e59e4db26bad9d48bb59de3f1fe"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab4353e59e4db26bad9d48bb59de3f1fe">&#9670;&nbsp;</a></span>resume()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool DobbyRunC::resume </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classContainerId.html">ContainerId</a> &amp;&#160;</td>
          <td class="paramname"><em>id</em></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Runs the runc command line tool with the 'resume' command. </p>
<p>This is equivalent to calling the following on the command line </p><pre class="fragment">/usr/sbin/runc resume &lt;id&gt;
</pre> <dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">id</td><td>The id / name of the container to resume.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>true or false based on the return code of the runc tool. </dd></dl>

</div>
</div>
<a id="afddb9167812aa2aca4318660e635b3b3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#afddb9167812aa2aca4318660e635b3b3">&#9670;&nbsp;</a></span>run()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">pid_t DobbyRunC::run </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classContainerId.html">ContainerId</a> &amp;&#160;</td>
          <td class="paramname"><em>id</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::shared_ptr&lt; const <a class="el" href="classDobbyBundle.html">DobbyBundle</a> &gt; &amp;&#160;</td>
          <td class="paramname"><em>bundle</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::shared_ptr&lt; const <a class="el" href="classIDobbyStream.html">IDobbyStream</a> &gt; &amp;&#160;</td>
          <td class="paramname"><em>console</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::list&lt; int &gt; &amp;&#160;</td>
          <td class="paramname"><em>files</em> = <code>std::list&lt;int&gt;()</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Runs the runc command line tool with the 'run' command. </p>
<p>This is equivalent to calling the following on the command line </p><pre class="fragment">/usr/sbin/runc run --bundle &lt;dir&gt; &lt;id&gt;
</pre><p> The pid of the runc tool is returned, this will survive until the container is destroyed. A watch should be placed on the pid to determine when it quits and this is the point the container is destroyed.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">id</td><td>The id / name of the container to create </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">bundle</td><td>The bundle directory to pass to the runc tool </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">console</td><td>The stream to attach to the stdout / stderr of the runc tool. This in effect is the console out of the container. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">files</td><td>A list of file descriptors to pass into the container.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>the pid of the runc process if successful, otherwise -1. </dd></dl>

</div>
</div>
<a id="a42581f202bddd15bca1166a164984510"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a42581f202bddd15bca1166a164984510">&#9670;&nbsp;</a></span>start()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool DobbyRunC::start </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classContainerId.html">ContainerId</a> &amp;&#160;</td>
          <td class="paramname"><em>id</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::shared_ptr&lt; const <a class="el" href="classIDobbyStream.html">IDobbyStream</a> &gt; &amp;&#160;</td>
          <td class="paramname"><em>console</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Starts a container created with <em>create</em> command. </p>
<p>This is equivalent to calling the following on the command line /usr/sbin/runc start &ndash;bundle &lt;dir&gt; &lt;id&gt;</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">id</td><td>The id of the container created earlier </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">console</td><td>The stream to attach to the stdout / stderr of the runc tool.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>true on success, false on failure. </dd></dl>

</div>
</div>
<a id="a8e10ced10e2ddd397379a4a93468085d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8e10ced10e2ddd397379a4a93468085d">&#9670;&nbsp;</a></span>state()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">DobbyRunC::ContainerStatus DobbyRunC::state </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classContainerId.html">ContainerId</a> &amp;&#160;</td>
          <td class="paramname"><em>id</em></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Runs the runc command line tool with the 'state' command. </p>
<p>This is equivalent to calling the following on the command line </p><pre class="fragment">/usr/sbin/runc state &lt;id&gt;
</pre><p> The response is json formatted for easy parsing of the container data.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">id</td><td>The id / name of the container to get the state for.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>the container state, or ContainerStatus::Unknown if the container isn't running. </dd></dl>

</div>
</div>
<hr/>The documentation for this class was generated from the following files:<ul>
<li>daemon/lib/source/<a class="el" href="DobbyRunC_8h_source.html">DobbyRunC.h</a></li>
<li>daemon/lib/source/DobbyRunC.cpp</li>
</ul>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.1
</small></address>
</body>
</html>
