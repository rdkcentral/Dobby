<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.9.1"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Dobby: DobbyTemplate Class Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Dobby
   &#160;<span id="projectnumber">3.0</span>
   </div>
   <div id="projectbrief">Dobby “Docker based Thingy” is a tool for managing and running OCI containers using crun</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.1 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#pub-static-methods">Static Public Member Functions</a> &#124;
<a href="#pri-methods">Private Member Functions</a> &#124;
<a href="#pri-static-methods">Static Private Member Functions</a> &#124;
<a href="#pri-attribs">Private Attributes</a> &#124;
<a href="#pri-static-attribs">Static Private Attributes</a> &#124;
<a href="classDobbyTemplate-members.html">List of all members</a>  </div>
  <div class="headertitle">
<div class="title">DobbyTemplate Class Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>Singleton class that returns the OCI JSON template.  
 <a href="classDobbyTemplate.html#details">More...</a></p>

<p><code>#include &lt;<a class="el" href="DobbyTemplate_8h_source.html">DobbyTemplate.h</a>&gt;</code></p>
<div class="dynheader">
Collaboration diagram for DobbyTemplate:</div>
<div class="dyncontent">
<div class="center"><img src="classDobbyTemplate__coll__graph.png" border="0" usemap="#aDobbyTemplate_coll__map" alt="Collaboration graph"/></div>
<map name="aDobbyTemplate_coll__map" id="aDobbyTemplate_coll__map">
<area shape="rect" title="Singleton class that returns the OCI JSON template." alt="" coords="5,5,129,32"/>
</map>
<center><span class="legend">[<a href="graph_legend.html">legend</a>]</span></center></div>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-static-methods"></a>
Static Public Member Functions</h2></td></tr>
<tr class="memitem:a031394304afcfa3b701d6975d3e58c1f"><td class="memItemLeft" align="right" valign="top"><a id="a031394304afcfa3b701d6975d3e58c1f"></a>
static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classDobbyTemplate.html#a031394304afcfa3b701d6975d3e58c1f">setSettings</a> (const std::shared_ptr&lt; const <a class="el" href="classIDobbySettings.html">IDobbySettings</a> &gt; &amp;settings)</td></tr>
<tr class="memdesc:a031394304afcfa3b701d6975d3e58c1f"><td class="mdescLeft">&#160;</td><td class="mdescRight">Applies the settings to the global template values. <br /></td></tr>
<tr class="separator:a031394304afcfa3b701d6975d3e58c1f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a53cc8d3f245761324c18cc9d37d12ec0"><td class="memItemLeft" align="right" valign="top">static std::string&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classDobbyTemplate.html#a53cc8d3f245761324c18cc9d37d12ec0">apply</a> (const ctemplate::TemplateDictionaryInterface *dictionary, bool prettyPrint)</td></tr>
<tr class="memdesc:a53cc8d3f245761324c18cc9d37d12ec0"><td class="mdescLeft">&#160;</td><td class="mdescRight">Applies the dictionary to the template.  <a href="classDobbyTemplate.html#a53cc8d3f245761324c18cc9d37d12ec0">More...</a><br /></td></tr>
<tr class="separator:a53cc8d3f245761324c18cc9d37d12ec0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa1cb060337e849da982f26179e7aadb8"><td class="memItemLeft" align="right" valign="top">static bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classDobbyTemplate.html#aa1cb060337e849da982f26179e7aadb8">applyAt</a> (int dirFd, const std::string &amp;fileName, const ctemplate::TemplateDictionaryInterface *dictionary, bool prettyPrint)</td></tr>
<tr class="memdesc:aa1cb060337e849da982f26179e7aadb8"><td class="mdescLeft">&#160;</td><td class="mdescRight">Applies the dictionary to the template and writes the output into the file.  <a href="classDobbyTemplate.html#aa1cb060337e849da982f26179e7aadb8">More...</a><br /></td></tr>
<tr class="separator:aa1cb060337e849da982f26179e7aadb8"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pri-methods"></a>
Private Member Functions</h2></td></tr>
<tr class="memitem:aae841eb57fd57714786e0bbab39f851c"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classDobbyTemplate.html#aae841eb57fd57714786e0bbab39f851c">setTemplateDevNodes</a> (const std::list&lt; std::string &gt; &amp;devNodes)</td></tr>
<tr class="memdesc:aae841eb57fd57714786e0bbab39f851c"><td class="mdescLeft">&#160;</td><td class="mdescRight">Sets up the global template values for the device nodes.  <a href="classDobbyTemplate.html#aae841eb57fd57714786e0bbab39f851c">More...</a><br /></td></tr>
<tr class="separator:aae841eb57fd57714786e0bbab39f851c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae8de0b1223d16d4e164671cd6b89f0bb"><td class="memItemLeft" align="right" valign="top"><a id="ae8de0b1223d16d4e164671cd6b89f0bb"></a>
void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classDobbyTemplate.html#ae8de0b1223d16d4e164671cd6b89f0bb">setTemplateEnvVars</a> (const std::map&lt; std::string, std::string &gt; &amp;envVars)</td></tr>
<tr class="memdesc:ae8de0b1223d16d4e164671cd6b89f0bb"><td class="mdescLeft">&#160;</td><td class="mdescRight">Converts the envVars map to json formatted string and sets it as the EXTRA_ENV_VARS template value. <br /></td></tr>
<tr class="separator:ae8de0b1223d16d4e164671cd6b89f0bb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9576ad7c3b03f386132db1546a850983"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classDobbyTemplate.html#a9576ad7c3b03f386132db1546a850983">setTemplatePlatformEnvVars</a> ()</td></tr>
<tr class="memdesc:a9576ad7c3b03f386132db1546a850983"><td class="mdescLeft">&#160;</td><td class="mdescRight">Sets the environment variables used to identify the platform.  <a href="classDobbyTemplate.html#a9576ad7c3b03f386132db1546a850983">More...</a><br /></td></tr>
<tr class="separator:a9576ad7c3b03f386132db1546a850983"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a043fd1569012d16228874c161afb35e0"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classDobbyTemplate.html#a043fd1569012d16228874c161afb35e0">setTemplateCpuRtSched</a> ()</td></tr>
<tr class="memdesc:a043fd1569012d16228874c161afb35e0"><td class="mdescLeft">&#160;</td><td class="mdescRight">Determines if the kernel's CONFIG_RT_GROUP_SCHED is set or not.  <a href="classDobbyTemplate.html#a043fd1569012d16228874c161afb35e0">More...</a><br /></td></tr>
<tr class="separator:a043fd1569012d16228874c161afb35e0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abccf0597e940c5d3aa2d065ab5c707c6"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classDobbyTemplate.html#abccf0597e940c5d3aa2d065ab5c707c6">_setSettings</a> (const std::shared_ptr&lt; const <a class="el" href="classIDobbySettings.html">IDobbySettings</a> &gt; &amp;settings)</td></tr>
<tr class="memdesc:abccf0597e940c5d3aa2d065ab5c707c6"><td class="mdescLeft">&#160;</td><td class="mdescRight">Applies the settings to the global template values.  <a href="classDobbyTemplate.html#abccf0597e940c5d3aa2d065ab5c707c6">More...</a><br /></td></tr>
<tr class="separator:abccf0597e940c5d3aa2d065ab5c707c6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a28c4b9765c24510147cc2ce3ded23bcc"><td class="memItemLeft" align="right" valign="top">std::string&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classDobbyTemplate.html#a28c4b9765c24510147cc2ce3ded23bcc">_apply</a> (const ctemplate::TemplateDictionaryInterface *dictionary, bool prettyPrint) const</td></tr>
<tr class="memdesc:a28c4b9765c24510147cc2ce3ded23bcc"><td class="mdescLeft">&#160;</td><td class="mdescRight">Applies the dictionary to the template.  <a href="classDobbyTemplate.html#a28c4b9765c24510147cc2ce3ded23bcc">More...</a><br /></td></tr>
<tr class="separator:a28c4b9765c24510147cc2ce3ded23bcc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a83b7fd4ce619ea6095fb7e68e0e289d8"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classDobbyTemplate.html#a83b7fd4ce619ea6095fb7e68e0e289d8">_applyAt</a> (int dirFd, const std::string &amp;fileName, const ctemplate::TemplateDictionaryInterface *dictionary, bool prettyPrint) const</td></tr>
<tr class="memdesc:a83b7fd4ce619ea6095fb7e68e0e289d8"><td class="mdescLeft">&#160;</td><td class="mdescRight">Applies the dictionary to the template and writes the output into the file.  <a href="classDobbyTemplate.html#a83b7fd4ce619ea6095fb7e68e0e289d8">More...</a><br /></td></tr>
<tr class="separator:a83b7fd4ce619ea6095fb7e68e0e289d8"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pri-static-methods"></a>
Static Private Member Functions</h2></td></tr>
<tr class="memitem:a96b1541f8f69374655334f7e5f0fa3bc"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classDobbyTemplate.html#a96b1541f8f69374655334f7e5f0fa3bc">cleanUp</a> ()</td></tr>
<tr class="memdesc:a96b1541f8f69374655334f7e5f0fa3bc"><td class="mdescLeft">&#160;</td><td class="mdescRight">Called at shutdown time to clean up the singleton.  <a href="classDobbyTemplate.html#a96b1541f8f69374655334f7e5f0fa3bc">More...</a><br /></td></tr>
<tr class="separator:a96b1541f8f69374655334f7e5f0fa3bc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6c212bb06a58e625e2290223b4e0549d"><td class="memItemLeft" align="right" valign="top"><a id="a6c212bb06a58e625e2290223b4e0549d"></a>
static <a class="el" href="classDobbyTemplate.html">DobbyTemplate</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classDobbyTemplate.html#a6c212bb06a58e625e2290223b4e0549d">instance</a> ()</td></tr>
<tr class="memdesc:a6c212bb06a58e625e2290223b4e0549d"><td class="mdescLeft">&#160;</td><td class="mdescRight">Returns / creates singleton instance. <br /></td></tr>
<tr class="separator:a6c212bb06a58e625e2290223b4e0549d"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pri-attribs"></a>
Private Attributes</h2></td></tr>
<tr class="memitem:a587ead887dbc5d759494db3171346a61"><td class="memItemLeft" align="right" valign="top"><a id="a587ead887dbc5d759494db3171346a61"></a>
const ctemplate::TemplateString&#160;</td><td class="memItemRight" valign="bottom"><b>mTemplateKey</b></td></tr>
<tr class="separator:a587ead887dbc5d759494db3171346a61"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a11ddb589b61574dfb84d90b75d578ed4"><td class="memItemLeft" align="right" valign="top"><a id="a11ddb589b61574dfb84d90b75d578ed4"></a>
const std::unique_ptr&lt; ctemplate::TemplateCache &gt;&#160;</td><td class="memItemRight" valign="bottom"><b>mTemplateCache</b></td></tr>
<tr class="separator:a11ddb589b61574dfb84d90b75d578ed4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4062c4b5d82b5f61b41dc9bebf0aff8b"><td class="memItemLeft" align="right" valign="top"><a id="a4062c4b5d82b5f61b41dc9bebf0aff8b"></a>
std::map&lt; std::string, std::string &gt;&#160;</td><td class="memItemRight" valign="bottom"><b>mExtraEnvVars</b></td></tr>
<tr class="separator:a4062c4b5d82b5f61b41dc9bebf0aff8b"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pri-static-attribs"></a>
Static Private Attributes</h2></td></tr>
<tr class="memitem:a9cb27fc566aedc8c36fa4ca98afffb80"><td class="memItemLeft" align="right" valign="top"><a id="a9cb27fc566aedc8c36fa4ca98afffb80"></a>
static pthread_rwlock_t&#160;</td><td class="memItemRight" valign="bottom"><b>mInstanceLock</b> = PTHREAD_RWLOCK_INITIALIZER</td></tr>
<tr class="separator:a9cb27fc566aedc8c36fa4ca98afffb80"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3eb594425dd7bbc11f46ef0923ebe5f7"><td class="memItemLeft" align="right" valign="top"><a id="a3eb594425dd7bbc11f46ef0923ebe5f7"></a>
static <a class="el" href="classDobbyTemplate.html">DobbyTemplate</a> *&#160;</td><td class="memItemRight" valign="bottom"><b>mInstance</b> = nullptr</td></tr>
<tr class="separator:a3eb594425dd7bbc11f46ef0923ebe5f7"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Singleton class that returns the OCI JSON template. </p>
</div><h2 class="groupheader">Member Function Documentation</h2>
<a id="a28c4b9765c24510147cc2ce3ded23bcc"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a28c4b9765c24510147cc2ce3ded23bcc">&#9670;&nbsp;</a></span>_apply()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::string DobbyTemplate::_apply </td>
          <td>(</td>
          <td class="paramtype">const ctemplate::TemplateDictionaryInterface *&#160;</td>
          <td class="paramname"><em>dictionary</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>prettyPrint</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Applies the dictionary to the template. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">dictionary</td><td>The dictionary to apply</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>the expanded template string </dd></dl>

</div>
</div>
<a id="a83b7fd4ce619ea6095fb7e68e0e289d8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a83b7fd4ce619ea6095fb7e68e0e289d8">&#9670;&nbsp;</a></span>_applyAt()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">bool DobbyTemplate::_applyAt </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>dirFd</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::string &amp;&#160;</td>
          <td class="paramname"><em>fileName</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const ctemplate::TemplateDictionaryInterface *&#160;</td>
          <td class="paramname"><em>dictionary</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>prettyPrint</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Applies the dictionary to the template and writes the output into the file. </p>
<p>If the pathname given in <em>fileName</em> is relative, then it is interpreted relative to the directory referred to by the file descriptor dirfd. If <em>fileName</em> is relative and dirfd is the special value AT_FDCWD, then <em>fileName</em> is interpreted relative to the current working directory</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">dirFd</td><td>The directory of the file. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">fileName</td><td>The path to the file to write to. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">dictionary</td><td>The dictionary to apply.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>true on success, false on failure. </dd></dl>

</div>
</div>
<a id="abccf0597e940c5d3aa2d065ab5c707c6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#abccf0597e940c5d3aa2d065ab5c707c6">&#9670;&nbsp;</a></span>_setSettings()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void DobbyTemplate::_setSettings </td>
          <td>(</td>
          <td class="paramtype">const std::shared_ptr&lt; const <a class="el" href="classIDobbySettings.html">IDobbySettings</a> &gt; &amp;&#160;</td>
          <td class="paramname"><em>settings</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Applies the settings to the global template values. </p>
<p>This includes settings for the environment variables and GPU. </p>

</div>
</div>
<a id="a53cc8d3f245761324c18cc9d37d12ec0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a53cc8d3f245761324c18cc9d37d12ec0">&#9670;&nbsp;</a></span>apply()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::string DobbyTemplate::apply </td>
          <td>(</td>
          <td class="paramtype">const ctemplate::TemplateDictionaryInterface *&#160;</td>
          <td class="paramname"><em>dictionary</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>prettyPrint</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Applies the dictionary to the template. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">dictionary</td><td>The dictionary to apply </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">prettyPrint</td><td>Format the json file using pretty printer.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>the expanded template string </dd></dl>

</div>
</div>
<a id="aa1cb060337e849da982f26179e7aadb8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa1cb060337e849da982f26179e7aadb8">&#9670;&nbsp;</a></span>applyAt()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">bool DobbyTemplate::applyAt </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>dirFd</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::string &amp;&#160;</td>
          <td class="paramname"><em>fileName</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const ctemplate::TemplateDictionaryInterface *&#160;</td>
          <td class="paramname"><em>dictionary</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>prettyPrint</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Applies the dictionary to the template and writes the output into the file. </p>
<p>If the pathname given in <em>fileName</em> is relative, then it is interpreted relative to the directory referred to by the file descriptor dirfd. If <em>fileName</em> is relative and dirfd is the special value AT_FDCWD, then <em>fileName</em> is interpreted relative to the current working directory</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">dirFd</td><td>The directory of the file. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">fileName</td><td>The path to the file to write to. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">dictionary</td><td>The dictionary to apply. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">prettyPrint</td><td>Pretty print the json output.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>true on success, false on failure. </dd></dl>

</div>
</div>
<a id="a96b1541f8f69374655334f7e5f0fa3bc"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a96b1541f8f69374655334f7e5f0fa3bc">&#9670;&nbsp;</a></span>cleanUp()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void DobbyTemplate::cleanUp </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Called at shutdown time to clean up the singleton. </p>
<p>Callback installed as atexit(), frees the instance pointer. </p>

</div>
</div>
<a id="a043fd1569012d16228874c161afb35e0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a043fd1569012d16228874c161afb35e0">&#9670;&nbsp;</a></span>setTemplateCpuRtSched()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void DobbyTemplate::setTemplateCpuRtSched </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Determines if the kernel's CONFIG_RT_GROUP_SCHED is set or not. </p>
<p>If CONFIG_RT_GROUP_SCHED is set in the kernel config we need to give all containers a slice of runtime scheduler. So we check if the kernel is configured that way and if it is we enabled CGROUP_RTSCHD_ENABLED section in the template. </p>

</div>
</div>
<a id="aae841eb57fd57714786e0bbab39f851c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aae841eb57fd57714786e0bbab39f851c">&#9670;&nbsp;</a></span>setTemplateDevNodes()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void DobbyTemplate::setTemplateDevNodes </td>
          <td>(</td>
          <td class="paramtype">const std::list&lt; std::string &gt; &amp;&#160;</td>
          <td class="paramname"><em>devNodes</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Sets up the global template values for the device nodes. </p>
<dl class="deprecated"><dt><b><a class="el" href="deprecated.html#_deprecated000001">Deprecated:</a></b></dt><dd>This is now down lazily in the <a class="el" href="classDobbyConfig.html" title="Interface that configuration file parser classes have to implement.">DobbyConfig</a> component when starting the first container that requires the GPU.</dd></dl>
<p>Currently the device nodes are only for the xegl/opengl.</p>
<p>We need to get the device numbers from the file system as runc won't do that automatically for us. We could hard code them, but it's perfectly reasonable that they could change between driver releases.</p>
<p>Nb: this feels like the wrong place to be doing this, however for now it is convenient and the most efficient. </p>

</div>
</div>
<a id="a9576ad7c3b03f386132db1546a850983"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9576ad7c3b03f386132db1546a850983">&#9670;&nbsp;</a></span>setTemplatePlatformEnvVars()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void DobbyTemplate::setTemplatePlatformEnvVars </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Sets the environment variables used to identify the platform. </p>
<p>All containers get two environment variables that define the platform; </p><pre class="fragment">ETHAN_STB_TYPE  = [ "GW" | "MR" | "HIP" ]
ETHAN_STB_MODEL = [ "ES140" | "ES130" | "EM150" | "ES240" | "ESi240" | ... ]
</pre><p> For a list of model names refer to the following confluence page </p><pre class="fragment">https://www.stb.bskyb.com/confluence/display/2016/STB+HW+ID
</pre><p> To determine platform we check for the AI_PLATFORM_IDENT environment variable. This should have been set by the user (or upstart script) that started this daemon. If it's not present then we set both templates as empty and log an error. </p>

</div>
</div>
<hr/>The documentation for this class was generated from the following files:<ul>
<li>bundle/lib/include/<a class="el" href="DobbyTemplate_8h_source.html">DobbyTemplate.h</a></li>
<li>bundle/lib/source/DobbyTemplate.cpp</li>
</ul>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.1
</small></address>
</body>
</html>
