<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.8"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Dobby: PortForwarding Namespace Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">Dobby<span id="projectnumber">&#160;3.0</span>
   </div>
   <div id="projectbrief">Dobby “Docker based Thingy” is a tool for managing and running OCI containers using crun</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.8 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle"><div class="title">PortForwarding Namespace Reference</div></div>
</div><!--header-->
<div class="contents">

<p>Used to add iptables firewall rules to allow port forwarding between the container and the host.  
<a href="namespacePortForwarding.html#details">More...</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="func-members" name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a8604e91a373deeb31e90308fdce93839" id="r_a8604e91a373deeb31e90308fdce93839"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacePortForwarding.html#a8604e91a373deeb31e90308fdce93839">addPortForwards</a> (const std::shared_ptr&lt; <a class="el" href="classNetfilter.html">Netfilter</a> &gt; &amp;netfilter, const std::shared_ptr&lt; <a class="el" href="classNetworkingHelper.html">NetworkingHelper</a> &gt; &amp;helper, const std::string &amp;containerId, rt_defs_plugins_networking_data_port_forwarding *portsConfig)</td></tr>
<tr class="memdesc:a8604e91a373deeb31e90308fdce93839"><td class="mdescLeft">&#160;</td><td class="mdescRight">Adds the two iptables firewall rules to enable port forwarding.  <br /></td></tr>
<tr class="separator:a8604e91a373deeb31e90308fdce93839"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5b1c0eaa4535100e7e72ac55aae5faeb" id="r_a5b1c0eaa4535100e7e72ac55aae5faeb"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacePortForwarding.html#a5b1c0eaa4535100e7e72ac55aae5faeb">removePortForwards</a> (const std::shared_ptr&lt; <a class="el" href="classNetfilter.html">Netfilter</a> &gt; &amp;netfilter, const std::shared_ptr&lt; <a class="el" href="classNetworkingHelper.html">NetworkingHelper</a> &gt; &amp;helper, const std::string &amp;containerId, rt_defs_plugins_networking_data_port_forwarding *portsConfig)</td></tr>
<tr class="memdesc:a5b1c0eaa4535100e7e72ac55aae5faeb"><td class="mdescLeft">&#160;</td><td class="mdescRight">Removes port forwarding rules assigned to the container.  <br /></td></tr>
<tr class="separator:a5b1c0eaa4535100e7e72ac55aae5faeb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a06423769acf6b2b39bc0694b25f2ef7e" id="r_a06423769acf6b2b39bc0694b25f2ef7e"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacePortForwarding.html#a06423769acf6b2b39bc0694b25f2ef7e">addLocalhostMasquerading</a> (const std::shared_ptr&lt; <a class="el" href="classNetworkingHelper.html">NetworkingHelper</a> &gt; &amp;helper, const std::shared_ptr&lt; <a class="el" href="classDobbyRdkPluginUtils.html">DobbyRdkPluginUtils</a> &gt; &amp;utils, rt_defs_plugins_networking_data_port_forwarding *portsConfig)</td></tr>
<tr class="memdesc:a06423769acf6b2b39bc0694b25f2ef7e"><td class="mdescLeft">&#160;</td><td class="mdescRight">Adds iptables rules to forward packets from the container localhost to the host's localhost on specific ports. This removes the need to edit code to point to the bridge IP directly.  <br /></td></tr>
<tr class="separator:a06423769acf6b2b39bc0694b25f2ef7e"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Used to add iptables firewall rules to allow port forwarding between the container and the host. </p>
<p>Has the ability to both add rules to forward ports from container to host and from host to container.</p>
<dl class="section see"><dt>See also</dt><dd>the plugin's README.md for more details on usage.</dd></dl>
<p>This adds the necessary rules to iptables when the container is started and deletes them again when the container is stopped. All the rules are tagged (via an iptables comment) with the name of the container, this should ensure rules are correctly added and removed. </p>
</div><h2 class="groupheader">Function Documentation</h2>
<a id="a06423769acf6b2b39bc0694b25f2ef7e" name="a06423769acf6b2b39bc0694b25f2ef7e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a06423769acf6b2b39bc0694b25f2ef7e">&#9670;&#160;</a></span>addLocalhostMasquerading()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool PortForwarding::addLocalhostMasquerading </td>
          <td>(</td>
          <td class="paramtype">const std::shared_ptr&lt; <a class="el" href="classNetworkingHelper.html">NetworkingHelper</a> &gt; &amp;&#160;</td>
          <td class="paramname"><em>helper</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::shared_ptr&lt; <a class="el" href="classDobbyRdkPluginUtils.html">DobbyRdkPluginUtils</a> &gt; &amp;&#160;</td>
          <td class="paramname"><em>utils</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">rt_defs_plugins_networking_data_port_forwarding *&#160;</td>
          <td class="paramname"><em>portsConfig</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Adds iptables rules to forward packets from the container localhost to the host's localhost on specific ports. This removes the need to edit code to point to the bridge IP directly. </p>
<p>This must be run inside the container's network namespace</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">netfilter</td><td>Instance of <a class="el" href="classNetfilter.html" title="Class that can read / write iptables rule sets.">Netfilter</a> class. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">helper</td><td>Instance of <a class="el" href="classNetworkingHelper.html">NetworkingHelper</a>. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">containerId</td><td>Container identifier. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">portsConfig</td><td>libocispec structs containing ports to forward.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>true on success, otherwise false. </dd></dl>

</div>
</div>
<a id="a8604e91a373deeb31e90308fdce93839" name="a8604e91a373deeb31e90308fdce93839"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8604e91a373deeb31e90308fdce93839">&#9670;&#160;</a></span>addPortForwards()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool PortForwarding::addPortForwards </td>
          <td>(</td>
          <td class="paramtype">const std::shared_ptr&lt; <a class="el" href="classNetfilter.html">Netfilter</a> &gt; &amp;&#160;</td>
          <td class="paramname"><em>netfilter</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::shared_ptr&lt; <a class="el" href="classNetworkingHelper.html">NetworkingHelper</a> &gt; &amp;&#160;</td>
          <td class="paramname"><em>helper</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::string &amp;&#160;</td>
          <td class="paramname"><em>containerId</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">rt_defs_plugins_networking_data_port_forwarding *&#160;</td>
          <td class="paramname"><em>portsConfig</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Adds the two iptables firewall rules to enable port forwarding. </p>
<p>The 'protocol' field can be omitted in which case TCP will be specified.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">netfilter</td><td>Instance of <a class="el" href="classNetfilter.html" title="Class that can read / write iptables rule sets.">Netfilter</a> class. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">helper</td><td>Instance of <a class="el" href="classNetworkingHelper.html">NetworkingHelper</a>. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">containerId</td><td>Container identifier. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">portsConfig</td><td>libocispec structs containing ports to forward.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>true on success, otherwise false. </dd></dl>

</div>
</div>
<a id="a5b1c0eaa4535100e7e72ac55aae5faeb" name="a5b1c0eaa4535100e7e72ac55aae5faeb"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5b1c0eaa4535100e7e72ac55aae5faeb">&#9670;&#160;</a></span>removePortForwards()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool PortForwarding::removePortForwards </td>
          <td>(</td>
          <td class="paramtype">const std::shared_ptr&lt; <a class="el" href="classNetfilter.html">Netfilter</a> &gt; &amp;&#160;</td>
          <td class="paramname"><em>netfilter</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::shared_ptr&lt; <a class="el" href="classNetworkingHelper.html">NetworkingHelper</a> &gt; &amp;&#160;</td>
          <td class="paramname"><em>helper</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::string &amp;&#160;</td>
          <td class="paramname"><em>containerId</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">rt_defs_plugins_networking_data_port_forwarding *&#160;</td>
          <td class="paramname"><em>portsConfig</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Removes port forwarding rules assigned to the container. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">netfilter</td><td>Instance of <a class="el" href="classNetfilter.html" title="Class that can read / write iptables rule sets.">Netfilter</a> class. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">helper</td><td>Instance of <a class="el" href="classNetworkingHelper.html">NetworkingHelper</a>. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">containerId</td><td>Container identifier. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">portsConfig</td><td>libocispec structs containing ports to forward.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>true on success, otherwise false. </dd></dl>

</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.8
</small></address>
</body>
</html>
